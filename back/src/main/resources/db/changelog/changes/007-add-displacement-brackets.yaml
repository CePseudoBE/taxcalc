databaseChangeLog:
  # ============================================
  # DISPLACEMENT TO FISCAL HP MAPPING
  # Used for annual tax when user provides cylinder displacement instead of fiscal HP
  # Source: https://cartax.be/taxe-de-circulation-wallonie-2025/
  # ============================================

  - changeSet:
      id: 301
      author: backtaxes
      comment: "Add displacement to fiscal HP mapping brackets"
      changes:
        - sql:
            sql: |
              -- Displacement brackets map cylinder capacity (cm3) to fiscal HP
              -- This is used when user doesn't know their fiscal HP but knows displacement
              -- min_value = min displacement, max_value = max displacement, amount = fiscal HP
              INSERT INTO tax_brackets (region, tax_type, bracket_key, min_value, max_value, amount, valid_from) VALUES
              ('wallonia', 'annual', 'displacement_cc', 0, 750, 4, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 751, 950, 5, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 951, 1150, 6, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 1151, 1350, 7, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 1351, 1550, 8, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 1551, 1750, 9, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 1751, 1950, 10, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 1951, 2150, 11, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 2151, 2350, 12, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 2351, 2550, 13, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 2551, 2750, 14, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 2751, 3050, 15, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 3051, 3250, 16, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 3251, 3450, 17, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 3451, 3650, 18, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 3651, 3950, 19, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 3951, 4150, 20, '2025-01-01'),
              ('wallonia', 'annual', 'displacement_cc', 4151, NULL, 21, '2025-01-01');

  - changeSet:
      id: 302
      author: backtaxes
      comment: "Add displacement brackets for Brussels (same as Wallonia)"
      changes:
        - sql:
            sql: |
              INSERT INTO tax_brackets (region, tax_type, bracket_key, min_value, max_value, amount, valid_from) VALUES
              ('brussels', 'annual', 'displacement_cc', 0, 750, 4, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 751, 950, 5, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 951, 1150, 6, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 1151, 1350, 7, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 1351, 1550, 8, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 1551, 1750, 9, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 1751, 1950, 10, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 1951, 2150, 11, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 2151, 2350, 12, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 2351, 2550, 13, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 2551, 2750, 14, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 2751, 3050, 15, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 3051, 3250, 16, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 3251, 3450, 17, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 3451, 3650, 18, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 3651, 3950, 19, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 3951, 4150, 20, '2025-01-01'),
              ('brussels', 'annual', 'displacement_cc', 4151, NULL, 21, '2025-01-01');

  - changeSet:
      id: 303
      author: backtaxes
      comment: "Add displacement brackets for Flanders (same structure)"
      changes:
        - sql:
            sql: |
              INSERT INTO tax_brackets (region, tax_type, bracket_key, min_value, max_value, amount, valid_from) VALUES
              ('flanders', 'annual', 'displacement_cc', 0, 750, 4, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 751, 950, 5, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 951, 1150, 6, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 1151, 1350, 7, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 1351, 1550, 8, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 1551, 1750, 9, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 1751, 1950, 10, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 1951, 2150, 11, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 2151, 2350, 12, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 2351, 2550, 13, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 2551, 2750, 14, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 2751, 3050, 15, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 3051, 3250, 16, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 3251, 3450, 17, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 3451, 3650, 18, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 3651, 3950, 19, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 3951, 4150, 20, '2025-01-01'),
              ('flanders', 'annual', 'displacement_cc', 4151, NULL, 21, '2025-01-01');
